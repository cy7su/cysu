{% extends 'base.html' %} {% from 'macros/breadcrumbs.html' import admin_breadcrumb %} {% block title %}Админка:
Предметы{% endblock %} {% block breadcrumbs %} {{ admin_breadcrumb("Предметы") }} {% endblock %} {% block content %}
<div class="admin-page">
    <!-- Заголовок страницы -->
    <div class="admin-header">
        <div class="admin-header-content">
            <div class="admin-title-section">
                <h1 class="admin-title">
                    <i class="fas fa-book admin-title-icon"></i>
                    Управление предметами
                </h1>
                <p class="admin-subtitle">Создание и управление предметами системы</p>
            </div>
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-number">{{ subjects|length }}</div>
                    <div class="stat-label">Предметов</div>
                </div>
            </div>
        </div>
    </div>

    <div class="admin-content">
        <div class="admin-layout">
            <!-- Боковая панель для создания -->
            <div class="admin-sidebar">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">
                            <i class="fas fa-plus-circle"></i>
                            Создать предмет
                        </h3>
                    </div>
                    <div class="admin-card-body">
                        <form method="post" class="admin-form">
                            {{ form.hidden_tag() }}

                            <div class="form-group">
                                <label for="{{ form.title.id }}" class="form-label">
                                    <i class="fas fa-tag"></i>
                                    Название предмета
                                </label>
                                {{ form.title(class_='form-control admin-input', placeholder='Введите название
                                предмета') }} {% if form.title.errors %}
                                <div class="form-error">
                                    {% for error in form.title.errors %}
                                    <span class="error-message">{{ error }}</span>
                                    {% endfor %}
                                </div>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.description.id }}" class="form-label">
                                    <i class="fas fa-align-left"></i>
                                    Описание
                                </label>
                                {{ form.description(class_='form-control admin-textarea', placeholder='Введите описание
                                предмета', rows=4) }} {% if form.description.errors %}
                                <div class="form-error">
                                    {% for error in form.description.errors %}
                                    <span class="error-message">{{ error }}</span>
                                    {% endfor %}
                                </div>
                                {% endif %}
                            </div>

                            <button type="submit" class="btn btn-primary admin-btn-primary">
                                <i class="fas fa-plus"></i>
                                Создать предмет
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Основной контент -->
            <div class="admin-main">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">
                            <i class="fas fa-list"></i>
                            Список предметов
                        </h3>
                        <div class="admin-card-actions">
                            <button class="btn btn-outline-secondary btn-sm" onclick="refreshTable()">
                                <i class="fas fa-sync-alt"></i>
                                Обновить
                            </button>
                        </div>
                    </div>

                    <div class="admin-card-body p-0">
                        {% if subjects %}
                        <div class="admin-table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th class="admin-table-th">
                                            <i class="fas fa-hashtag"></i>
                                            ID
                                        </th>
                                        <th class="admin-table-th">
                                            <i class="fas fa-tag"></i>
                                            Название
                                        </th>
                                        <th class="admin-table-th">
                                            <i class="fas fa-align-left"></i>
                                            Описание
                                        </th>
                                        <th class="admin-table-th">
                                            <i class="fas fa-file-alt"></i>
                                            Материалы
                                        </th>
                                        <th class="admin-table-th">
                                            <i class="fas fa-cogs"></i>
                                            Действия
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for subject in subjects %}
                                    <tr class="admin-table-row">
                                        <td class="admin-table-td">
                                            <span class="admin-badge admin-badge-secondary">{{ subject.id }}</span>
                                        </td>
                                        <td class="admin-table-td">
                                            <div class="admin-table-cell-content">
                                                <strong class="admin-table-cell-title">{{ subject.title }}</strong>
                                            </div>
                                        </td>
                                        <td class="admin-table-td">
                                            <div class="admin-table-cell-content">
                                                <span class="admin-table-cell-description">
                                                    {{ subject.description[:100] }}{% if subject.description|length >
                                                    100 %}...{% endif %}
                                                </span>
                                            </div>
                                        </td>
                                        <td class="admin-table-td">
                                            <span class="admin-badge admin-badge-info">{{ subject.materials|length }} материалов</span>
                                        </td>
                                        <td class="admin-table-td">
                                            <div class="admin-table-actions">
                                                <a href="{{ url_for('main.subject_detail', subject_id=subject.id) }}" class="btn btn-outline-primary admin-btn-action" title="Просмотр">
                                                    <i class="fas fa-eye"></i>
                                                </a>
                                                <form method="post" action="{{ url_for('main.delete_subject', subject_id=subject.id) }}" class="admin-form-inline" id="deleteSubjectAdminForm{{ subject.id }}">
                                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                                                    <button type="button" class="btn btn-outline-danger admin-btn-action" title="Удалить" onclick="customConfirm('Удалить предмет?', function() { document.getElementById('deleteSubjectAdminForm{{ subject.id }}').submit(); })">
                                                        <i class="fas fa-trash"></i>
                                                    </button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                    {% else %}
                                    <tr class="admin-table-row">
                                        <td colspan="5" class="admin-empty-state">
                                            <div class="admin-empty-icon">
                                                <i class="fas fa-book"></i>
                                            </div>
                                            <h3 class="admin-empty-title">Нет предметов</h3>
                                            <p class="admin-empty-description">
                                                Создайте первый предмет, используя форму слева
                                            </p>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} {% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const patternSelect = document.getElementById('pattern-select')
        const patternPreview = document.getElementById('pattern-preview')

        // Функция обновления предварительного просмотра
        function updatePatternPreview() {
            const selectedPattern = patternSelect.value
            if (selectedPattern) {
                const pattern = SVGPatternGenerator.generatePattern(selectedPattern)
                patternPreview.style.backgroundImage = `url("data:image/svg+xml;base64,${btoa(pattern)}")`
            } else {
                patternPreview.style.backgroundImage = 'none'
            }
        }

        // Обработчик изменения выбора паттерна
        patternSelect.addEventListener('change', updatePatternPreview)

        // Инициализация предварительного просмотра
        updatePatternPreview()
    })
</script>
{% endblock %}